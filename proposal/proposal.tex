\documentclass[ms]{byuprop}

% Options for this class include the following (* indicates default): 
%   10pt -- 10 point font size 
%   11pt -- 11 point font size 
%   12pt (*) -- 12 point font size 
%
%   ms -- produce a thesis proposal (off) 
%   areaexam -- produce a research area overview (off) 
%   phd -- produce a dissertation proposal (off) 
%
%   layout -- show layout lines on the pages, helps with overfull boxes (off) 
%   grid -- show a half-inch grid on every page, helps with printing (off)

% This command fixes my particular printer, which starts 0.03 inches too low, 
% shifting the whole page down by that amount. This shifts the document 
% content up so that it comes out right when printed. 
%
% Discovering this sort of behavior is best done by specifying the ``grid'' 
% option in the class parameters above.  It prints a 1/2 inch grid on every 
% page. You can then use a ruler to determine exactly what the printer is 
% doing. 
% Uncomment to shift content up (accounting for printer problems)
%\setlength{\voffset}{-.03in}

% Here we set things up for invisible hyperlinks in the document. This makes 
% the electronic version clickable without changing the way that the document 
% prints. It's useful, but optional. Note that if you use pdflatex, you 
% should change "ps2pdf" to "pdftex". 
\usepackage[
	pdftex,
	bookmarks=true,
	breaklinks=true,
	raiselinks=true,
	pdfborder={0 0 0},
	colorlinks=false,
	]{hyperref}

% Rewrite the itemize, description, and enumerate environments to have more 
% reasonable spacing: 
\newcommand{\ItemSep}{\itemsep 0pt}
\let\oldenum=\enumerate
\renewcommand{\enumerate}{\oldenum \ItemSep}
\let\olditem=\itemize
\renewcommand{\itemize}{\olditem \ItemSep}
\let\olddesc=\description
\renewcommand{\description}{\olddesc \ItemSep}

% Get a little less fussy about word spacing on a line.  Sometimes produces 
% ugly results, so keep your eyes peeled. 
\sloppy

% Important settings for the byuprop class. %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Because I use these things in more than one place, I created new commands for 
% them. I did not use \providecommand because I absolutely want LaTeX to error 
% out if these already exist. 

\newcommand{\Title}{A Static Type System for Continuation Marks}
\newcommand{\Author}{Kimball R. Germane} 
\newcommand{\SubmissionMonth}{May}
\newcommand{\SubmissionYear}{2012}

% Take these from the commands defined above
\title{\Title}
\author{\Author}
\monthsubmitted{\SubmissionMonth} 
\yearsubmitted{\SubmissionYear}

% Committee members 
\committeechair{Jay McCarthy} 
\committeemembera{Sean Warnick} 
\committeememberb{}
\committeememberc{} 
\committeememberd{}

% Department graduate coordinator 
\graduatecoordinator{Dan Ventura}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Set up the internal PDF information so that it becomes part of the document 
% metadata. The pdfinfo command will display this. Be sure to set the document 
% type and add your own keywords. 
\hypersetup{%
	pdftitle=\Title,%
	pdfauthor=\Author,%
	pdfsubject={Document Type, BYU CS Department: %
				Submitted \SubmissionMonth~\SubmissionYear, Created \today},%
	pdfkeywords={},%
}

% These packages allow the bibliography to be sorted alphabetically and allow references
% to more than one paper to be sorted and compressed (i.e. instead of [5,2,4,6] you get
% [2,4-6]) 

%\usepackage[numbers,sort&compress]{natbib}
%\usepackage{hypernat}

% Additional packages required for your specific thesis go here. I've left some I use as
% examples. 
%\usepackage{graphicx}
%\usepackage{pdfsync}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{float}

\floatstyle{boxed} 
\restylefloat{figure}

\newcounter{definition}
\newcounter{example}

\begin{document}

% Produce the preamble
\maketitle


%\abstract{}

\section{Introduction}

% remember that the audience in this case actually does not know what these things are 
% so have a clear, useful exposition.

Thesis: Continuation marks have a type. (?)

% talk more about how they are useful here, elaboration will be below

Continuation marks \cite{clements2006portable} are a language feature that provides a
mechanism to annotate the dynamic context of a program. This feature allows the
association of arbitrary values with arbitrary keys for the lifetime of an execution
context and the inquiry of currently defined values of pending contexts for a given set of
keys. This is advantageous for programs that require dynamic information about a program
execution such as debuggers, profilers, and steppers because it allows them to be defined
at the same level as the language instead of some level below.

\section{Related Work}

\subsection{Continuation Marks}

There are certain tools that are indispensable to some programmers that concern the
behavior of their programs: debuggers, profilers, steppers, etc. Without these tools,
these programmers cannot justify the adoption of a language, however compelling it might
otherwise be. Traditionally, these tools are developed at the same level as the 
language, privy to incidental implementation detail, precisely because that detail 
enables these tools to function. This is problematic for at least two reasons. First, 
it couples the implementation of the tool with the implementation of the language, which
increases the cost to port to other platforms. If users become dependent upon these tools,
it can stall the advancement of the language and the adoption of new language features.
Second and more critical, it makes these tools unsound. For instance, debuggers typically
examine programs which have been compiled without optimizations. In general, this means 
that the debugged program has different behavior than the deployed program. This is 
obviously undesirable.

It is desirable to implement such tools at the same level as the language, removing
dependency upon the implementation an instead relying on definitional and behavioral
invariants. Continuation marks are a language-level feature that provide the information
necessary for these tools to function. Furthermore, languages which require stack
inspection to enforce security policies (\emph{Java}, \emph{C\#}) or support aspect
oriented programming (\emph{aspectj}) can be defined in terms of a simpler language with
continuation marks.

The feature of continuation marks itself is accessible via two surface level syntactic
forms: \emph{with-continuation-mark} and \emph{current-continuation-marks}.

\emph{with-continuation-mark} has three parameters: a key expression \emph{key-expr}, a 
value expression \emph{value-expr} and a body expression \emph{body-expr}. The evaluation 
of \emph{value-expr} will be associated with a key, the evaluation of \emph{key-expr}, 
before the evaluation of \emph{body-expr}. During the lifetime of the evaluation of 
\emph{body-expr}, a continuation mark will exist associated with this key. In a Scheme-like 
syntax, this call appears like so:

% will use slatex for the dissertation; too much of a hassle now
\texttt{(with-continuation-mark} \emph{key-expr} \emph{value-expr} \emph{body-expr}\texttt{)}

\emph{current-continuation-marks} has one parameter, a set of keys \emph{key-set}, and returns a list of
all the associated values attached to the dynamic context of the invocation. If a particular 
context has been annotated by more than one key in the set, this will be reflected in the 
returned list\footnote{The returned list is typically a list of non-empty lists where each 
sub-list represents the marks on a context.}. Additionally, the order in which values were 
attached with a particular key is preserved. Scheme-like, \emph{current-continuation-marks}
looks like this:

\texttt{(current-continuation-marks} \emph{key-set}\texttt{)}

Importantly, the result of \emph{current-continuation-marks} provides no evidence of any portion of the
dynamic context lacking continuation marks with the specified keys. This preserves the
ability to perform optimizations without exposing details which would render the
optimizations unsound. This also requires special consideration of a language that
supports tail call optimization (which is not an optimization in the above sense since its
behavior is defined in the semantics of the language). By definition, \emph{body-expr} is 
in tail position; a language with tail call optimization will reflect this.

The canonical example to illustrate the behavior of continuation marks in the presence and
absence of proper tail recursion is the factorial function.

Figure \ref{fac-rec} illustrates the definitional recursive variant of the factorial
function. In this actualization, a cascade of multiplication operations builds as the
recursive calls are made. Each multiplication is computation that must be performed after
the recursive call of which the machine must keep track.

\begin{figure}
\begin{verbatim}
(define (fact n)
  (if (= n 0)
      1
      (* n (fact (- n 1)))))
\end{verbatim}
\caption{The definitionally recursive factorial function}
\label{fac-rec}
\end{figure}

Figure \ref{fac-tail-rec} illustrates the tail recursive manifestation of the factorial
function. In contrast to the function in figure \ref{fac-rec}, this formulation performs
the multiplication before the recursive call. Because the function has no pending
computations after the evaluation of the recursive call, the execution context need not
grow. Such a call is said to be in tail position.

\begin{figure}
\begin{verbatim}
(define (fact-tr n acc)
  (if (= n 0)
      acc
      (fact-tr (- n 1) (* n acc))))
\end{verbatim}
\caption{A tail-recursive variant of the factorial function}
\label{fac-tail-rec}
\end{figure}

Figures \ref{fac-rec-cm} and \ref{fac-tail-rec-cm} represent these two variants of the
factorial function augmented with continuation marks.


\begin{figure}
\begin{verbatim}
(define (fact n)
  (if (= n 0)
      (begin
        (display (current-continuation-marks '(fact)))
        1)
      (with-continuation-mark 'fact n (* n (fact (- n 1)))))
\end{verbatim}
\caption{The definitionally recursive factorial function augmented with continuation marks}
\label{fac-rec-cm}
\end{figure}

\begin{figure}
\begin{verbatim}
(define (fact-tr n acc)
  (if (= n 0)
      (begin
        (display (current-continuation-marks '(fact)))
        acc)
      (with-continuation-mark 'fact n (fact-tr (- n 1) (* n acc))))
\end{verbatim}
\caption{The tail-recursive factorial function augmented with continuation marks}
\label{fac-tail-rec-cm}
\end{figure}

The result of \texttt{(fact 3)} would be

\begin{verbatim}
(((fact 1)) ((fact 2)) ((fact 3)))
6
\end{verbatim}

whereas the result of \texttt{(fact-tr 3 1)} would be

\begin{verbatim}
(((fact 1)))
6
\end{verbatim}

This difference is due to the growing continuation in the definitionally recursive
\texttt{fact}. Each call to \texttt{fact} has a pending computation--namely, the
multiplication--after the recursive call and so each necessitates the creation an
additional evaluation context. The effect of these additional contexts is that each
annotation is applied to a new, ``blank'' context, so all the annotations are preserved. In
the tail-recursive variant, there is no pending computation and therefore no additional
evaluation context. In this instance, the previous mark is overwritten with the new.

\section{Project Description}

\section{Validation}

\section{Thesis Schedule}

Less than five years.

%Abstract – 1 to 2 paragraphs summarizing the proposal. Introduction – 1 to 4 pages
%answering questions 1 and 2 above Related Work – 1 to 2 pages answering question 3 above.
%Thesis statement – 1 to 2 sentences stating what is to be demonstrated in your thesis.
%Project Description – 2 to 5 pages answering question 4 above. Validation – 1/2 to 2 pages
%answering question 5 above. Thesis Schedule – ¼ to ½ page specifying dates for completion
%of major milestones. Annotated Bibliography – 2 to 5 pages containing references for all
%work cited.

%%%%%%%%%%%%%%%%%%%%%%%%%

% Change these to reflect the bibliography style and bibtex database file you want to use
\bibliographystyle{annotate}
\bibliography{proposal}

\end{document}
